var FlashDetect={version:{Major:0,Minor:0,Revision:0},isIE:navigator.appVersion.indexOf("MSIE")!=-1?true:false,isWin:navigator.appVersion.toLowerCase().indexOf("win")!=-1?true:false,isOpera:navigator.userAgent.indexOf("Opera")!=-1?true:false,GetSwfVer:function(){var a=new Array;if(navigator.plugins!=null&&navigator.plugins.length>0){for(x=0;x<navigator.plugins.length;x++){if(navigator.plugins[x].name.indexOf("Shockwave Flash")>=0){a.push(navigator.plugins[x])}}var b=[0,0,0];for(x=0;x<a.length;x++){var c=a[x].description;var d=c.split(" ");var e=d[2].split(".");e.push(parseInt(d[d.length-1].substr(1,d[d.length-1].length)));var f=parseInt(e[0]);var g=parseInt(e[1]);var h=parseInt(e[2]);e=[f,g,h];if(e[0]>b[0]||e[0]==b[0]&&e[1]>b[1]||e[0]==b[0]&&e[1]==b[1]&&e[2]>b[2]){b=e}}this.version.Major=b[0];this.version.Minor=b[1];this.version.Revision=b[2]}else if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1)flashVer=4;else if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1)flashVer=3;else if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1)flashVer=2;else if(FlashDetect.isIE&&FlashDetect.isWin&&!FlashDetect.isOpera){flashVer=this.ControlVersion();if(flashVer==-1)return this.version;flashVerString=flashVer+"";if(flashVerString.indexOf("WIN")>=0){flashVer=flashVerString.substr(flashVerString.indexOf("WIN")+4,flashVerString.length)}b=flashVer.split(",");this.version.Major=b[0];this.version.Minor=b[1];this.version.Revision=b[2]}return this.version},ControlVersion:function(){var a;var b;var c;try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.9");a=b.GetVariable("$version")}catch(c){}try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.8");a=b.GetVariable("$version")}catch(c){}try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");a=b.GetVariable("$version")}catch(c){}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");a="WIN 6,0,21,0";b.AllowScriptAccess="always";a=b.GetVariable("$version")}catch(c){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");a=b.GetVariable("$version")}catch(c){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");a="WIN 3,0,18,0"}catch(c){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");a="WIN 2,0,0,11"}catch(c){a=-1}}return a},DetectVersion:function(a,b,c){var d=this.GetSwfVer();return d.Major>a||d.Major==a&&d.Minor>b||d.Major==a&&d.Minor==b&&d.Revision>=c}}
